
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Locomotion tracking in Pigeons &#8212; Pigeon Super Model</title>
    
  <link href="_static/css/theme.css" rel="stylesheet">
  <link href="_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-book-theme.css?digest=84ace793992934648b4de8eed757e5a2" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.9d8b4a8b9bb19db25eeaddc40d639ba2.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <link rel="shortcut icon" href="_static/icon.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="SLEAP" href="SLEAP.html" />
    <link rel="prev" title="Using Anipose for 3D Pose Reconstruction" href="UsingAnipose3D.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<div class="col-12 col-md-3 bd-sidebar site-navigation " id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="_static/PigeonSuperModel.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Pigeon Super Model</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="intro.html">
   Welcome
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="Dataset.html">
   Dataset
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Models.html">
   Models
  </a>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="Tutorial.html">
   Tutorial
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="DeepLabCut.html">
     DeepLabCut
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
    <label for="toctree-checkbox-2">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3">
      <a class="reference internal" href="HowToPigeonSuperModel.html">
       How to use the PigeonSuperModel
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="HowToPigeonSuperModelDataset.html">
       How to use the PigeonSuperModel DataSet
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="DLC_StudentGuide.html">
       DeepLabCut -
       <em>
        A Studentâ€™s Quick Start Guide
       </em>
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="UsingAnipose3D.html">
       Using Anipose for 3D Pose Reconstruction
      </a>
     </li>
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Locomotion tracking in Pigeons
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="SLEAP.html">
     SLEAP
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://gitlab.ruhr-uni-bochum.de/ikn/pigeonsupermodel">
   GitLab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://gitlab.ruhr-uni-bochum.de/ikn/pigeonsupermodel/-/releases">
   Releases
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference external" href="https://www.ruhr-uni-bochum.de/biopsy/members.html">
   Biopsychology Lab
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="GetInTouch.html">
   Get in Touch
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<!-- This is an invisible pixel that we watch to see if we've scrolled. -->
<div class="sbt-scroll-pixel-helper"></div>
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            <div class="topbar-left">
                
                <label class="nav-toggle-button" for="__navigation">
                    <div class="visually-hidden">Toggle navigation</div>
                    <i class="fas fa-bars"></i>
                </label>
                
            </div>
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/LocomotionTrackingPigeon.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
                onclick="printPdf(this)" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://gitlab.ruhr-uni-bochum.de/ikn/pigeonsupermodel"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://gitlab.ruhr-uni-bochum.de/ikn/pigeonsupermodel/issues/new?title=Issue%20on%20page%20%2FLocomotionTrackingPigeon.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show noprint">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#helper-functions">
   Helper Functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-3d-datasets">
   Load 3D datasets
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extract-reference-points-for-arena-reconstruction">
     Extract Reference Points for Arena Reconstruction
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reduce-pigeon-pose-to-spine-centroid">
     Reduce Pigeon Pose to Spine Centroid
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analyze-kinematic-profile-to-separate-stops-from-bouts">
   Analyze Kinematic Profile to Separate Stops from Bouts
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resample-data-resolution">
     Resample Data resolution
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#count-frames-on-quadrant-for-spatial-distribution">
   Count Frames on Quadrant for Spatial Distribution
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-figures-of-spatial-distribution">
     Plot Figures of Spatial Distribution
    </a>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Locomotion tracking in Pigeons</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#helper-functions">
   Helper Functions
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-3d-datasets">
   Load 3D datasets
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#extract-reference-points-for-arena-reconstruction">
     Extract Reference Points for Arena Reconstruction
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#reduce-pigeon-pose-to-spine-centroid">
     Reduce Pigeon Pose to Spine Centroid
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#analyze-kinematic-profile-to-separate-stops-from-bouts">
   Analyze Kinematic Profile to Separate Stops from Bouts
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#resample-data-resolution">
     Resample Data resolution
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#count-frames-on-quadrant-for-spatial-distribution">
   Count Frames on Quadrant for Spatial Distribution
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#plot-figures-of-spatial-distribution">
     Plot Figures of Spatial Distribution
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="locomotion-tracking-in-pigeons">
<h1>Locomotion tracking in Pigeons<a class="headerlink" href="#locomotion-tracking-in-pigeons" title="Permalink to this headline">Â¶</a></h1>
<p>This is the code we used for the SfN 2022 Abstract submission on <a class="reference external" href="https://www.abstractsonline.com/cSubmit/SubmitPrinterFriendlyVersion.asp?ControlKey=EB4BB529%2D4271%2D43E7%2DB33B%2DB8C48A36B8E3&amp;MeetingActivityKey=%7BA8A513A0%2DB922%2D40E7%2D93BC%2D326953EB0E67%7D&amp;AKey=%7B3A7DC0B9%2DD787%2D44AA%2DBD08%2DFA7BB2FE9004%7D&amp;MKey=%7B1446E249%2D2838%2D4164%2D8E59%2D5FAC2EE2F3C2%7D">3d tracking of freely moving pigeons reveals behavioral differences during space and color discrimination tasks</a>.</p>
<p><strong>Abstract:</strong></p>
<p>Measuring behavior has become increasingly popular in neuroscience, and decisive advances in machine learning have enabled robust quantification of animal movement in ever less restrictive setups. Pigeons are a great example of a standard model in cognitive neuroscience whose natural behavior has been systematically restricted during cognitive tasks and thus remains under-investigated. We, therefore, propose a versatile approach to investigate cognition-guided behavior in minimally restricted conditions. Such an approach would increase ecological validity in neuroscience, and the quantification of behavior would provide a statistical control measure for animal movement within tasks. To this end, we built a multi-camera 3D tracking arena for cognitive testing in freely moving pigeons using markerless pose estimation and robust camera triangulation at high resolutions, for long recording periods of up to 80 minutes. With over 100 hours of video data, we show that 3D pose estimation with 6 cameras can reliably reconstruct the naturally upright pose of pigeons in a 4m2 field of view at a distance of up to 2.8m. For instance, the body size of individual pigeons can be accurately estimated through the additional z-axis (length: 303.12mm Â± 14.06mm; height: 239.74mm Â± 5.65mm), and head movements during locomotion and pecking reveal characteristic kinematic components in vertical and horizontal axes. Comparing different cognitive tasks for space and color discrimination on multiple touch screens, we show that pigeons exhibit different spatial navigation strategies between feeders, using distinct path traces and different preferred sections within the arena. Moreover, animals show individual differences in the overall symmetry of their use of space, as well as in average locomotion speed and total distance traveled. Further quantification of pigeonsâ€™ behavior on the tasks will be an important control to disentangle context- and task-associated neural activity in core brain structures.</p>
<p>Download this notebook in the upper right corner as .ipynb file and install <code class="docutils literal notranslate"><span class="pre">geopandas</span></code> to follow along. We used 3D reconstructed pigeon poses using the PigeonSuperModel, DeepLabCut and Anipose:</p>
<ul class="simple">
<li><p>Load 3D data from Anipose</p>
<ul>
<li><p>Extract Arena Reference</p></li>
<li><p>Reduce Pigeon Pose</p></li>
</ul>
</li>
<li><p>Analyze Kinematic Profiles</p>
<ul>
<li><p>Resample data Resolution</p></li>
</ul>
</li>
<li><p>Count Frames on Quadrant</p>
<ul>
<li><p>Plot Spatial Distribution</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># import libraries</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">geopandas</span> <span class="k">as</span> <span class="nn">gpd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">make_axes_locatable</span>
<span class="kn">from</span> <span class="nn">shapely.ops</span> <span class="kn">import</span> <span class="n">triangulate</span>
<span class="kn">from</span> <span class="nn">shapely.geometry</span> <span class="kn">import</span> <span class="n">Polygon</span><span class="p">,</span> <span class="n">Point</span><span class="p">,</span> <span class="n">MultiPolygon</span><span class="p">,</span> <span class="n">MultiPoint</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="helper-functions">
<h2>Helper Functions<a class="headerlink" href="#helper-functions" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fit_pointmap</span><span class="p">(</span><span class="n">grain</span><span class="p">,</span> <span class="n">points</span><span class="p">):</span>
    <span class="c1"># create points with x and y coordinates</span>
    <span class="n">pointmap</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">shape</span> <span class="o">=</span> <span class="n">Polygon</span><span class="p">(</span><span class="n">points</span><span class="p">)</span>
    
    <span class="c1"># create a horizontal, equidistant line of point between with `grain` number of points </span>
    <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">MultiPoint</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">MultiPoint</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="p">),</span> <span class="n">grain</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">float</span><span class="p">):</span>

        <span class="c1"># create a vertical, equidistant line of point between with `grain` number of points </span>
        <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">MultiPoint</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="p">),</span> <span class="nb">max</span><span class="p">(</span><span class="n">MultiPoint</span><span class="p">(</span><span class="n">points</span><span class="p">)</span><span class="o">.</span><span class="n">bounds</span><span class="p">),</span> <span class="n">grain</span><span class="p">,</span> <span class="n">dtype</span> <span class="o">=</span> <span class="nb">float</span><span class="p">):</span>
            
            <span class="c1"># within the double loop, define point with x and y coordinates</span>
            <span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">)</span>

            <span class="c1"># filter points outside the original hexagon arena</span>
            <span class="k">if</span> <span class="n">shape</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
                <span class="n">pointmap</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    
    <span class="k">return</span> <span class="n">pointmap</span>
    
<span class="k">def</span> <span class="nf">fit_quadrants</span><span class="p">(</span><span class="nb">map</span><span class="p">,</span> <span class="n">step</span><span class="p">):</span>
    <span class="c1"># initialize quad_size</span>
    <span class="n">quad_size</span> <span class="o">=</span> <span class="mi">0</span>
    
    <span class="c1"># initialize quadrants</span>
    <span class="n">quadrants</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">quad_size</span><span class="p">,</span> <span class="n">cap_style</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">]</span>

    <span class="k">while</span> <span class="n">MultiPolygon</span><span class="p">(</span><span class="n">quadrants</span><span class="p">)</span><span class="o">.</span><span class="n">is_valid</span><span class="p">:</span>
        <span class="n">quad_size</span> <span class="o">+=</span> <span class="n">step</span>

        <span class="c1"># create quadrant grid</span>
        <span class="n">quadrants</span> <span class="o">=</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">buffer</span><span class="p">(</span><span class="n">quad_size</span><span class="p">,</span> <span class="n">cap_style</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">map</span><span class="p">]</span>

    <span class="k">return</span> <span class="n">quad_size</span><span class="p">,</span> <span class="n">quadrants</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="load-3d-datasets">
<h2>Load 3D datasets<a class="headerlink" href="#load-3d-datasets" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># P175: last space autoshaping </span>
<span class="n">filename_1</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/Users/guillermo/Sciebo/Workspace/HexArenaData/merged_20220309_HexagonalArena_P175.csv&#39;</span>
<span class="c1"># P171: first space discrimination</span>
<span class="n">filename_2</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/Users/guillermo/Sciebo/Workspace/HexArenaData/merged_20220310_HexagonalArena_P171.csv&#39;</span>
<span class="c1"># P172: color discrimination</span>
<span class="n">filename_3</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;/Users/guillermo/Sciebo/Workspace/HexArenaData/merged_20220330_HexagonalArena_P172.csv&#39;</span>

<span class="n">df1</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename_1</span><span class="p">)</span>
<span class="n">df2</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename_2</span><span class="p">)</span>
<span class="n">df3</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">filename_3</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="extract-reference-points-for-arena-reconstruction">
<h3>Extract Reference Points for Arena Reconstruction<a class="headerlink" href="#extract-reference-points-for-arena-reconstruction" title="Permalink to this headline">Â¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">df</span> <span class="ow">in</span> <span class="p">[</span><span class="n">df1</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">df3</span><span class="p">]:</span>
    <span class="c1"># extract coordinates as points</span>
    <span class="n">cA</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;cA_x&#39;</span><span class="p">)],</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;cA_y&#39;</span><span class="p">)],</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;cA_z&#39;</span><span class="p">)]))</span>
    <span class="n">cB</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;cB_x&#39;</span><span class="p">)],</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;cB_y&#39;</span><span class="p">)],</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;cB_z&#39;</span><span class="p">)]))</span>
    <span class="n">cC</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;cC_x&#39;</span><span class="p">)],</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;cC_y&#39;</span><span class="p">)],</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;cC_z&#39;</span><span class="p">)]))</span>
    <span class="n">cD</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;cD_x&#39;</span><span class="p">)],</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;cD_y&#39;</span><span class="p">)],</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;cD_z&#39;</span><span class="p">)]))</span>
    <span class="n">cE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;cE_x&#39;</span><span class="p">)],</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;cE_y&#39;</span><span class="p">)],</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;cE_z&#39;</span><span class="p">)]))</span>
    <span class="n">cF</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">((</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;cF_x&#39;</span><span class="p">)],</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;cF_y&#39;</span><span class="p">)],</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s1">&#39;cF_z&#39;</span><span class="p">)]))</span>
    <span class="n">hexagonpoints</span> <span class="o">=</span> <span class="p">[</span><span class="n">Point</span><span class="p">(</span><span class="n">cA</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="n">cB</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="n">cC</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="n">cD</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="n">cE</span><span class="p">),</span> <span class="n">Point</span><span class="p">(</span><span class="n">cF</span><span class="p">)]</span>

    <span class="c1"># select grid parameters</span>
    <span class="n">grain</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1"># this defines how many quadrants to fit</span>
    <span class="n">step</span> <span class="o">=</span> <span class="mi">30</span> <span class="c1"># this defines degree of overlapping between quadrants</span>

    <span class="nb">map</span> <span class="o">=</span> <span class="n">fit_pointmap</span><span class="p">(</span><span class="n">grain</span><span class="p">,</span> <span class="n">hexagonpoints</span><span class="p">)</span>
    <span class="n">quad_size</span><span class="p">,</span> <span class="n">quadrants</span> <span class="o">=</span> <span class="n">fit_quadrants</span><span class="p">(</span><span class="nb">map</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>

    <span class="n">corners</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">hexagonpoints</span><span class="p">)</span>
    <span class="n">pointgrid</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="nb">map</span><span class="p">)</span>
    <span class="n">quadgrid</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoSeries</span><span class="p">(</span><span class="n">quadrants</span><span class="p">)</span>

    <span class="c1"># Plot Arena Mapping</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
    <span class="n">corners</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax1</span><span class="p">,</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span>
            <span class="n">markersize</span> <span class="o">=</span> <span class="mi">50</span><span class="p">,</span>
            <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">edgecolors</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mi">1</span><span class="p">);</span>

    <span class="n">pointgrid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span><span class="o">=</span><span class="n">ax2</span><span class="p">,</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span>
            <span class="n">markersize</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span>
            <span class="n">linewidth</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
            <span class="n">edgecolors</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.7</span><span class="p">);</span>

    <span class="n">quadgrid</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ax</span> <span class="o">=</span> <span class="n">ax3</span><span class="p">,</span>
            <span class="n">color</span> <span class="o">=</span> <span class="s1">&#39;gray&#39;</span><span class="p">,</span> 
            <span class="n">linewidth</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">,</span>
            <span class="n">edgecolors</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span>
            <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">);</span>

    <span class="n">ax1</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;Original Coordinates&#39;</span><span class="p">);</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Fitted Pointmap with grain: </span><span class="si">{</span><span class="n">grain</span><span class="si">}</span><span class="s1"> and </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">quadgrid</span><span class="p">)</span><span class="si">}</span><span class="s1"> quadrants&#39;</span><span class="p">);</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Quadrant mapping with quadrants of </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">quadrants</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">area</span><span class="p">)</span><span class="si">:</span><span class="s1">.2f</span><span class="si">}</span><span class="s1"> $mm$&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/LocomotionTrackingPigeon_7_0.png" src="_images/LocomotionTrackingPigeon_7_0.png" />
<img alt="_images/LocomotionTrackingPigeon_7_1.png" src="_images/LocomotionTrackingPigeon_7_1.png" />
<img alt="_images/LocomotionTrackingPigeon_7_2.png" src="_images/LocomotionTrackingPigeon_7_2.png" />
</div>
</div>
</div>
<div class="section" id="reduce-pigeon-pose-to-spine-centroid">
<h3>Reduce Pigeon Pose to Spine Centroid<a class="headerlink" href="#reduce-pigeon-pose-to-spine-centroid" title="Permalink to this headline">Â¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">timewindow</span> <span class="o">=</span> <span class="mi">5</span><span class="c1">#  min</span>
<span class="n">starttime</span> <span class="o">=</span> <span class="mi">20000</span> <span class="c1"># frame</span>
<span class="n">endtime</span> <span class="o">=</span> <span class="n">starttime</span> <span class="o">+</span> <span class="p">(</span><span class="n">timewindow</span><span class="o">*</span><span class="mi">60</span><span class="o">*</span><span class="mi">75</span><span class="p">)</span>

<span class="n">pigeon1</span> <span class="o">=</span> <span class="n">df1</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">df1</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;UHS&quot;</span><span class="p">)]</span>
<span class="n">pigeon1</span> <span class="o">=</span> <span class="n">pigeon1</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">starttime</span><span class="p">:</span><span class="n">endtime</span><span class="p">,</span> <span class="n">pigeon1</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;x|y|z&quot;</span><span class="p">)]</span>

<span class="n">pigeon2</span> <span class="o">=</span> <span class="n">df2</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">df2</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;UHS&quot;</span><span class="p">)]</span>
<span class="n">pigeon2</span> <span class="o">=</span> <span class="n">pigeon2</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">starttime</span><span class="p">:</span><span class="n">endtime</span><span class="p">,</span> <span class="n">pigeon2</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;x|y|z&quot;</span><span class="p">)]</span>

<span class="n">pigeon3</span> <span class="o">=</span> <span class="n">df3</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">df3</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;UHS&quot;</span><span class="p">)]</span>
<span class="n">pigeon3</span> <span class="o">=</span> <span class="n">pigeon3</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">starttime</span><span class="p">:</span><span class="n">endtime</span><span class="p">,</span> <span class="n">pigeon3</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;x|y|z&quot;</span><span class="p">)]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="analyze-kinematic-profile-to-separate-stops-from-bouts">
<h2>Analyze Kinematic Profile to Separate Stops from Bouts<a class="headerlink" href="#analyze-kinematic-profile-to-separate-stops-from-bouts" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_stops</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">all_max_total_movement</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">pigeon</span> <span class="ow">in</span> <span class="p">[</span><span class="n">pigeon1</span><span class="p">,</span> <span class="n">pigeon2</span><span class="p">,</span> <span class="n">pigeon3</span><span class="p">]:</span>
    <span class="c1"># calculate speed as displacement between subsequent frames</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">pigeon</span><span class="p">[</span><span class="n">pigeon</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">pigeon</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;x&quot;</span><span class="p">)]]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">pigeon</span><span class="p">[</span><span class="n">pigeon</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">pigeon</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="s2">&quot;y&quot;</span><span class="p">)]]</span><span class="o">.</span><span class="n">values</span>
    <span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">75</span> <span class="c1"># conversion Hz to sec</span>
    <span class="n">v</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="o">*</span> <span class="mi">75</span>

    <span class="c1"># calculate absolute speed</span>
    <span class="c1">#total_speed = abs(u)+abs(v)</span>
    <span class="n">total_speed</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">u</span><span class="o">**</span><span class="mi">2</span><span class="o">+</span><span class="n">v</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>

    <span class="c1"># realistic boundries, see plot below</span>
    <span class="n">inactivity</span> <span class="o">=</span> <span class="mi">90</span>
    <span class="n">outlier</span> <span class="o">=</span> <span class="mi">1500</span>

    <span class="c1"># find stops</span>
    <span class="n">stops</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">total_speed</span><span class="p">)</span>
    <span class="n">stops</span><span class="p">[</span><span class="n">stops</span><span class="o">&gt;</span><span class="n">inactivity</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="c1"># find movement</span>
    <span class="n">max_total_movement</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">total_speed</span><span class="p">)</span>
    <span class="n">max_total_movement</span><span class="p">[</span><span class="n">total_speed</span><span class="o">&lt;</span><span class="n">inactivity</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    <span class="n">max_total_movement</span><span class="p">[</span><span class="n">total_speed</span><span class="o">&gt;</span><span class="n">outlier</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
    
    <span class="c1"># save data</span>
    <span class="n">all_stops</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">stops</span><span class="p">)</span>
    <span class="n">all_max_total_movement</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">max_total_movement</span><span class="p">)</span>
    
    <span class="c1"># plot Kinematics</span>
    <span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">,</span> <span class="n">ax4</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">))</span>
    <span class="c1"># plot 1</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Pigeon locomotion speed in x- and y-coordinates&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (frames @75Hz)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Speed [mm/sec]&#39;</span><span class="p">);</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">u</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;x-coord&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;y-coord&#39;</span><span class="p">)</span>
    <span class="n">ax1</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>

    <span class="c1"># plot 2</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Pigeon locomotion speed in x- and y-coordinates&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (frames)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Speed (mm / sec)&#39;</span><span class="p">);</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">total_speed</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;absolute speed in any coord&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">outlier</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;outlier threshold&#39;</span><span class="p">)</span>
    <span class="n">ax2</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># plot 3</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Frequency of Pigeon locomotion speed between consecutive frames&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Speed (mm / sec)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Absolute Frequency&#39;</span><span class="p">);</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">total_speed</span><span class="p">,</span> <span class="n">bins</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;distribution speed&#39;</span><span class="p">);</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">inactivity</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;inactivity threshold&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">outlier</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;outlier threshold&#39;</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
    <span class="n">ax3</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="c1"># plot 4</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Pigeon locomotion speed in x- and y-coordinates&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time (frames)&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Speed (mm / sec)&#39;</span><span class="p">);</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">max_total_movement</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;movement&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">stops</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;inactivity&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">inactivity</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;inactivity threshold&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">axhline</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="n">outlier</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s1">&#39;outlier threshold&#39;</span><span class="p">)</span>
    <span class="n">ax4</span><span class="o">.</span><span class="n">legend</span><span class="p">();</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/LocomotionTrackingPigeon_11_0.png" src="_images/LocomotionTrackingPigeon_11_0.png" />
<img alt="_images/LocomotionTrackingPigeon_11_1.png" src="_images/LocomotionTrackingPigeon_11_1.png" />
<img alt="_images/LocomotionTrackingPigeon_11_2.png" src="_images/LocomotionTrackingPigeon_11_2.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_bout_events</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_stops</span><span class="p">)):</span>
    <span class="n">stop_events</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_stops</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">if</span> <span class="n">all_stops</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">stop_events</span><span class="p">)</span><span class="si">}</span><span class="s1"> stop frames in </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">all_stops</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">}</span><span class="s1"> total frames [</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">stop_events</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">all_stops</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">%]&#39;</span><span class="p">)</span>
    <span class="n">bout_events</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">all_max_total_movement</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">if</span> <span class="n">all_max_total_movement</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">idx</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Found </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">bout_events</span><span class="p">)</span><span class="si">}</span><span class="s1"> movement frames in </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">all_max_total_movement</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">}</span><span class="s1"> total frames [</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">bout_events</span><span class="p">)</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">all_max_total_movement</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s1">.0f</span><span class="si">}</span><span class="s1">%]&#39;</span><span class="p">)</span>
    <span class="n">outliers</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_max_total_movement</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">-</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">stop_events</span><span class="p">)</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">bout_events</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Found </span><span class="si">{</span><span class="n">outliers</span><span class="si">}</span><span class="s1"> outlier frames in </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">all_max_total_movement</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">}</span><span class="s1"> total frames [</span><span class="si">{</span><span class="mi">100</span><span class="o">*</span><span class="n">outliers</span><span class="o">/</span><span class="nb">len</span><span class="p">(</span><span class="n">all_max_total_movement</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="si">:</span><span class="s1">.3f</span><span class="si">}</span><span class="s1">%]&#39;</span><span class="p">)</span>
    <span class="n">all_bout_events</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bout_events</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Found 4737 stop frames in 22500 total frames [21%]
Found 17746 movement frames in 22500 total frames [79%]
Found 17 outlier frames in 22500 total frames [0.076%]
Found 4940 stop frames in 22500 total frames [22%]
Found 17560 movement frames in 22500 total frames [78%]
Found 0 outlier frames in 22500 total frames [0.000%]
Found 3438 stop frames in 22500 total frames [15%]
Found 18881 movement frames in 22500 total frames [84%]
Found 181 outlier frames in 22500 total frames [0.804%]
</pre></div>
</div>
</div>
</div>
<div class="section" id="resample-data-resolution">
<h3>Resample Data resolution<a class="headerlink" href="#resample-data-resolution" title="Permalink to this headline">Â¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">all_res_pigeon_bouts</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">pigeon</span> <span class="ow">in</span> <span class="p">[</span><span class="n">pigeon1</span><span class="p">,</span> <span class="n">pigeon2</span><span class="p">,</span> <span class="n">pigeon3</span><span class="p">]:</span>
    <span class="c1"># subset stops</span>
    <span class="n">pigeon_stops</span> <span class="o">=</span> <span class="n">pigeon</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">stop_events</span><span class="p">]</span>
    <span class="n">pigeon_bouts</span> <span class="o">=</span> <span class="n">pigeon</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">bout_events</span><span class="p">]</span>

    <span class="c1"># resample stops</span>
    <span class="n">fps</span> <span class="o">=</span> <span class="mi">75</span>
    <span class="n">res_fps</span> <span class="o">=</span> <span class="mi">30</span>
    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pigeon_stops</span><span class="p">)</span>
    <span class="n">res_length</span> <span class="o">=</span> <span class="n">length</span><span class="o">/</span><span class="n">fps</span><span class="o">*</span><span class="n">res_fps</span>
    <span class="n">chunks</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">length</span><span class="o">/</span><span class="p">(</span><span class="n">length</span><span class="o">/</span><span class="n">res_length</span><span class="p">))</span>
    <span class="n">res_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">chunks</span><span class="p">)</span>
    <span class="n">res_pigeon_stops</span> <span class="o">=</span> <span class="n">pigeon_stops</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">res_index</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># resample bouts</span>
    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">pigeon_bouts</span><span class="p">)</span>
    <span class="n">res_length</span> <span class="o">=</span> <span class="n">length</span><span class="o">/</span><span class="n">fps</span><span class="o">*</span><span class="n">res_fps</span>
    <span class="n">chunks</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">length</span><span class="o">/</span><span class="p">(</span><span class="n">length</span><span class="o">/</span><span class="n">res_length</span><span class="p">))</span>
    <span class="n">res_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">length</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="n">chunks</span><span class="p">)</span>
    <span class="n">res_pigeon_bouts</span> <span class="o">=</span> <span class="n">pigeon_bouts</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">res_index</span><span class="p">]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">all_res_pigeon_bouts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res_pigeon_bouts</span><span class="p">)</span>


<span class="n">res_pigeon_bouts1</span> <span class="o">=</span> <span class="n">all_res_pigeon_bouts</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">res_pigeon_bouts2</span> <span class="o">=</span> <span class="n">all_res_pigeon_bouts</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">res_pigeon_bouts3</span> <span class="o">=</span> <span class="n">all_res_pigeon_bouts</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="count-frames-on-quadrant-for-spatial-distribution">
<h2>Count Frames on Quadrant for Spatial Distribution<a class="headerlink" href="#count-frames-on-quadrant-for-spatial-distribution" title="Permalink to this headline">Â¶</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># calculate pigeon path</span>

<span class="c1"># Find point in polygon</span>
<span class="n">visits1</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">visits2</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">visits3</span> <span class="o">=</span> <span class="p">[]</span>

<span class="c1">## P1</span>
<span class="c1"># get coordinates in every time frame</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res_pigeon_bouts1</span><span class="p">)):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">res_pigeon_bouts1</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">t</span><span class="p">,:])</span>
    <span class="c1"># assign quadrant that contains pigeon location</span>
    <span class="n">boollist</span> <span class="o">=</span> <span class="n">quadgrid</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="p">[</span><span class="n">visits1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">boollist</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="p">]</span>

<span class="c1"># count visit per quadrant index</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">visits1</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">visits1</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">quadgrid</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># create GeoPandas Data Frame</span>
<span class="n">boutcount1</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">counts</span><span class="p">,</span> <span class="n">quadgrid</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">boutcount1</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;visits&quot;</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">]</span>

<span class="c1">## P2</span>
<span class="c1"># get coordinates in every time frame</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res_pigeon_bouts2</span><span class="p">)):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">res_pigeon_bouts2</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">t</span><span class="p">,:])</span>
    <span class="c1"># assign quadrant that contains pigeon location</span>
    <span class="n">boollist</span> <span class="o">=</span> <span class="n">quadgrid</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="p">[</span><span class="n">visits2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">boollist</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="p">]</span>

<span class="c1"># count visit per quadrant index</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">visits2</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">visits2</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">quadgrid</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># create GeoPandas Data Frame</span>
<span class="n">boutcount2</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">counts</span><span class="p">,</span> <span class="n">quadgrid</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">boutcount2</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;visits&quot;</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">]</span>

<span class="c1">## P3</span>
<span class="c1"># get coordinates in every time frame</span>
<span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">res_pigeon_bouts3</span><span class="p">)):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">res_pigeon_bouts3</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">t</span><span class="p">,:])</span>
    <span class="c1"># assign quadrant that contains pigeon location</span>
    <span class="n">boollist</span> <span class="o">=</span> <span class="n">quadgrid</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">p</span><span class="p">)</span>
    <span class="p">[</span><span class="n">visits3</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">boollist</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span><span class="p">]</span>

<span class="c1"># count visit per quadrant index</span>
<span class="n">counts</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">visits3</span><span class="p">)</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">visits3</span><span class="p">)</span><span class="o">.</span><span class="n">size</span><span class="p">()</span><span class="o">.</span><span class="n">reindex</span><span class="p">(</span><span class="n">quadgrid</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">fill_value</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="c1"># create GeoPandas Data Frame</span>
<span class="n">boutcount3</span> <span class="o">=</span> <span class="n">gpd</span><span class="o">.</span><span class="n">GeoDataFrame</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">counts</span><span class="p">,</span> <span class="n">quadgrid</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">boutcount3</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;visits&quot;</span><span class="p">,</span> <span class="s2">&quot;geometry&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="plot-figures-of-spatial-distribution">
<h3>Plot Figures of Spatial Distribution<a class="headerlink" href="#plot-figures-of-spatial-distribution" title="Permalink to this headline">Â¶</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s1">&#39;font.size&#39;</span><span class="p">:</span><span class="mi">25</span><span class="p">})</span>

<span class="c1"># Plot Pigeon Locomotion</span>
<span class="n">fig</span><span class="p">,</span> <span class="p">(</span><span class="n">ax1</span><span class="p">,</span> <span class="n">ax2</span><span class="p">,</span> <span class="n">ax3</span><span class="p">)</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span>

<span class="c1"># plot 1</span>
<span class="n">divider1</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax1</span><span class="p">)</span>
<span class="n">cax1</span> <span class="o">=</span> <span class="n">divider1</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">boutcount1</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;visits&#39;</span><span class="p">,</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">ax1</span><span class="p">,</span> 
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax1</span><span class="p">);</span>

<span class="c1"># plot 2</span>
<span class="n">divider2</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax2</span><span class="p">)</span>
<span class="n">cax2</span> <span class="o">=</span> <span class="n">divider2</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">boutcount2</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;visits&#39;</span><span class="p">,</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">ax2</span><span class="p">,</span> 
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax2</span><span class="p">);</span>

<span class="c1"># plot 3</span>
<span class="n">divider3</span> <span class="o">=</span> <span class="n">make_axes_locatable</span><span class="p">(</span><span class="n">ax3</span><span class="p">)</span>
<span class="n">cax3</span> <span class="o">=</span> <span class="n">divider3</span><span class="o">.</span><span class="n">append_axes</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;5%&quot;</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">boutcount3</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">column</span><span class="o">=</span><span class="s1">&#39;visits&#39;</span><span class="p">,</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">ax3</span><span class="p">,</span> 
        <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;jet&#39;</span><span class="p">,</span>
        <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.9</span><span class="p">,</span> <span class="n">legend</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">cax</span><span class="o">=</span><span class="n">cax3</span><span class="p">);</span>

<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s2">&quot;Spatial Frequency of Pigeon Locomotion in a 5min Time Window &quot;</span><span class="p">)</span>
<span class="n">ax1</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Pigeon P175 session 20220309&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x-coordinate [mm]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;y-coordinate [mm]&#39;</span><span class="p">);</span>
<span class="n">ax2</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Pigeon P171 session 20220310&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x-coordinate [mm]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;y-coordinate [mm]&#39;</span><span class="p">);</span>
<span class="n">ax3</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="n">title</span> <span class="o">=</span> <span class="s1">&#39;Pigeon P172 session 20220330&#39;</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;x-coordinate [mm]&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;y-coordinate [mm]&#39;</span><span class="p">);</span>

<span class="n">cax1</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Frame count @</span><span class="si">{</span><span class="n">res_fps</span><span class="si">}</span><span class="s1">Hz &#39;</span><span class="p">);</span>
<span class="n">cax2</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Frame count @</span><span class="si">{</span><span class="n">res_fps</span><span class="si">}</span><span class="s1">Hz &#39;</span><span class="p">);</span>
<span class="n">cax3</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Frame count @</span><span class="si">{</span><span class="n">res_fps</span><span class="si">}</span><span class="s1">Hz &#39;</span><span class="p">);</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="c1"># reset</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcdefaults</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/LocomotionTrackingPigeon_18_0.png" src="_images/LocomotionTrackingPigeon_18_0.png" />
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            
                <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="UsingAnipose3D.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Using Anipose for 3D Pose Reconstruction</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="SLEAP.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">SLEAP</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            
        </div>
    </div>
    <footer class="footer">
  <p>
    
      By Guillermo Hidalgo Gadea & Sarah C. MÃ¶ser, IKN, Ruhr-University Bochum<br/>
    
        &copy; Copyright 2022.<br/>
  </p>
</footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>